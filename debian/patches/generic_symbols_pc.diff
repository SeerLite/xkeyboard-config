Index: xkb-data/symbols/pc
===================================================================
--- xkb-data.orig/symbols/pc
+++ xkb-data/symbols/pc
@@ -8,20 +8,10 @@
 
     key <ESC>  {	[ Escape			]	};
 
-    // Alphanumeric section
-    key <TLDE> {	[     grave,	asciitilde	]	};
-    key <AE01> {	[	  1,	exclam 		]	};
-    key <AE02> {	[	  2,	at		]	};
-    key <AE03> {	[	  3,	numbersign	]	};
-    key <AE04> {	[	  4,	dollar		]	};
-    key <AE05> {	[	  5,	percent		]	};
-    key <AE06> {	[	  6,	asciicircum	]	};
-    key <AE07> {	[	  7,	ampersand	]	};
-    key <AE08> {	[	  8,	asterisk	]	};
-    key <AE09> {	[	  9,	parenleft	]	};
-    key <AE10> {	[	  0,	parenright	]	};
-    key <AE11> {	[     minus,	underscore	]	};
-    key <AE12> {	[     equal,	plus		]	};
+    include "pc(alpha)"
+    include "pc(function)"
+    include "pc(editing)"
+    include "pc(keypad)"
 
     key <BKSP> {
         type="CTRL+ALT",
@@ -34,10 +24,8 @@
     key <CAPS> {	[	Caps_Lock		]	};
 
     key <LFSH> {	[ 	 Shift_L		]	};
-    key <BKSL> {	[ backslash,	bar		]	};
 
     key <LCTL> {	[ 	 Control_L		]	};
-    key <SPCE> {	[ 	 space			]	};
 
     key <RTSH> {	[ 	Shift_R		]	};
     key <LALT> {	[ 	Alt_L	 	]	};
@@ -46,7 +34,89 @@
 
     // End alphanumeric section
 
-    // Begin "Function" section
+    // begin modifier mappings
+    modifier_map Shift  { Shift_L, Shift_R };
+    modifier_map Lock   { Caps_Lock, ISO_Lock };
+    modifier_map Control{ Control_L, Control_R };
+    modifier_map Mod2   { Num_Lock };
+
+    //  Fake keys for virtual<->real modifiers mapping 
+    key <LVL3> {	[ ISO_Level3_Shift	]	};
+    key <MDSW> {	[ Mode_switch 		]	};
+    modifier_map Mod5   { <LVL3>, <MDSW> };
+
+    key <ALT>  {	[ NoSymbol, Alt_L	]	};
+    modifier_map Mod1   { <ALT>, <LALT> };
+
+    key <META> {	[ NoSymbol, Meta_L	]	};
+    modifier_map Mod1   { <META> };
+
+    key <SUPR> {	[ NoSymbol, Super_L	]	};
+    modifier_map Mod4   { <SUPR> };
+
+    key <HYPR> {	[ NoSymbol, Hyper_L	]	};
+    modifier_map Mod4   { <HYPR> };
+};
+
+// definition for the PC-AT type 101 key keyboard
+xkb_symbols "pc101" {
+    include "pc(basic)"
+    key <LALT> {	[ 	Alt_L,	Meta_L 		]	};
+    key <RALT> {	[	Alt_R,	Meta_R		]	};
+
+};
+
+// definition for the extra key on 102-key keyboards
+xkb_symbols "pc102" {
+    include "pc(pc101)"
+};
+
+// definition for the extra keys on 104-key "Windows95" keyboards
+default
+xkb_symbols "pc104" {
+    include "pc(basic)"
+    key <LALT> {	[ 	Alt_L,	Meta_L		]	};
+    key <RALT> {	[	Alt_R,	Meta_R		]	};
+    key <LWIN> {	[	Super_L			]	};
+    key <RWIN> {	[	Super_R			]	};
+    key <MENU> {	[	Menu			]	};
+
+};
+
+// defintion which includes both the Windows95 keyboards _and_
+// the extra key on most European keyboards.
+xkb_symbols "pc105" {
+    include "pc(pc104)"
+};
+
+partial hidden alphanumeric_keys
+xkb_symbols "alpha" {
+
+    // Alphanumeric section
+    key <TLDE> {	[     grave,	asciitilde	]	};
+    key <AE01> {	[	  1,	exclam 		]	};
+    key <AE02> {	[	  2,	at		]	};
+    key <AE03> {	[	  3,	numbersign	]	};
+    key <AE04> {	[	  4,	dollar		]	};
+    key <AE05> {	[	  5,	percent		]	};
+    key <AE06> {	[	  6,	asciicircum	]	};
+    key <AE07> {	[	  7,	ampersand	]	};
+    key <AE08> {	[	  8,	asterisk	]	};
+    key <AE09> {	[	  9,	parenleft	]	};
+    key <AE10> {	[	  0,	parenright	]	};
+    key <AE11> {	[     minus,	underscore	]	};
+    key <AE12> {	[     equal,	plus		]	};
+
+    // the extra key on most European keyboards
+    key <LSGT> { [      less,    greater,          bar,    brokenbar ]	};
+
+    // these keys are common to all layouts
+    key <BKSL> {	[ backslash,	bar		]	};
+    key <SPCE> {	[ 	 space			]	};
+};
+
+partial hidden alphanumeric_keys
+xkb_symbols "function" {
     key <FK01> {
         type="CTRL+ALT",
         symbols[Group1]= [ F1,	XF86_Switch_VT_1 ]
@@ -95,31 +165,10 @@
         type="CTRL+ALT",
         symbols[Group1]= [ F12,	XF86_Switch_VT_12 ]
     };
-    // End "Function" section
-
-    // Begin "Editing" section
-    key <PRSC> {
-	type= "PC_SYSRQ",
-	symbols[Group1]= [ Print, Sys_Req ]
-    };
-    key <SCLK> {  [  Scroll_Lock	]	};
-    key <PAUS> {
-	type= "PC_BREAK",
-	symbols[Group1]= [ Pause, Break ]
-    };
-    key  <INS> {	[  Insert		]	};
-    key <HOME> {	[  Home			]	};
-    key <PGUP> {	[  Prior		]	};
-    key <DELE> {	[  Delete		]	};
-    key  <END> {	[  End			]	};
-    key <PGDN> {	[  Next			]	};
-
-    key   <UP> {	[  Up			]	};
-    key <LEFT> {	[  Left			]	};
-    key <DOWN> {	[  Down			]	};
-    key <RGHT> {	[  Right		]	};
+};
 
-    // End "Editing" section, begin "Keypad"
+partial hidden alphanumeric_keys
+xkb_symbols "keypad" {
     key <NMLK> {	[  Num_Lock, Pointer_EnableKeys		]	};
 
 // Ungrab cancels server/keyboard/pointer grabs
@@ -162,85 +211,37 @@
 
     key  <KP0> {	[  KP_Insert,	KP_0	]	};
     key <KPDL> {  	[  KP_Delete,	KP_Decimal ]	};
-    // End "Keypad" section
-
-    // begin modifier mappings
-    modifier_map Shift  { Shift_L, Shift_R };
-    modifier_map Lock   { Caps_Lock, ISO_Lock };
-    modifier_map Control{ Control_L, Control_R };
-    modifier_map Mod2   { Num_Lock };
-
-    //  Fake keys for virtual<->real modifiers mapping 
-    key <LVL3> {	[ ISO_Level3_Shift	]	};
-    key <MDSW> {	[ Mode_switch 		]	};
-    modifier_map Mod5   { <LVL3>, <MDSW> };
-
-    key <ALT>  {	[ NoSymbol, Alt_L	]	};
-    modifier_map Mod1   { <ALT>, <LALT> };
-
-    key <META> {	[ NoSymbol, Meta_L	]	};
-    modifier_map Mod1   { <META> };
-
-    key <SUPR> {	[ NoSymbol, Super_L	]	};
-    modifier_map Mod4   { <SUPR> };
-
-    key <HYPR> {	[ NoSymbol, Hyper_L	]	};
-    modifier_map Mod4   { <HYPR> };
-};
-
-// definition for the PC-AT type 101 key keyboard
-xkb_symbols "pc101" {
-    include "pc(basic)"
-    key <LALT> {	[ 	Alt_L,	Meta_L 		]	};
-    key <RALT> {	[	Alt_R,	Meta_R		]	};
-
 };
 
-// definition for the extra key on 102-key keyboards
-xkb_symbols "pc102" {
-    include "pc(pc101)"
-    key <LSGT> { [      less,    greater,          bar,    brokenbar ]	};
-};
-
-// definition for the extra keys on 104-key "Windows95" keyboards
-default
-xkb_symbols "pc104" {
-    include "pc(basic)"
-    key <LALT> {	[ 	Alt_L,	Meta_L		]	};
-    key <RALT> {	[	Alt_R,	Meta_R		]	};
-    key <LWIN> {	[	Super_L			]	};
-    key <RWIN> {	[	Super_R			]	};
-    key <MENU> {	[	Menu			]	};
-
-};
+partial hidden alphanumeric_keys
+xkb_symbols "editing" {
+    key <PRSC> {
+	type= "PC_SYSRQ",
+	symbols[Group1]= [ Print, Sys_Req ]
+    };
+    key <SCLK> {  [  Scroll_Lock	]	};
+    key <PAUS> {
+	type= "PC_BREAK",
+	symbols[Group1]= [ Pause, Break ]
+    };
+    key  <INS> {	[  Insert		]	};
+    key <HOME> {	[  Home			]	};
+    key <PGUP> {	[  Prior		]	};
+    key <DELE> {	[  Delete		]	};
+    key  <END> {	[  End			]	};
+    key <PGDN> {	[  Next			]	};
 
-// defintion which includes both the Windows95 keyboards _and_
-// the extra key on most European keyboards.
-xkb_symbols "pc105" {
-    include "pc(pc104)"
-    key <LSGT> { [      less,    greater,          bar,    brokenbar ]	};
+    key   <UP> {	[  Up			]	};
+    key <LEFT> {	[  Left			]	};
+    key <DOWN> {	[  Down			]	};
+    key <RGHT> {	[  Right		]	};
 };
 
 // common keys which can be overwritten in some layouts
+partial hidden alphanumeric_keys
 xkb_symbols "common" {
 
-    // Alphanumeric section
-    key <TLDE> {	[     grave,	asciitilde	]	};
-    key <AE01> {	[	  1,	exclam 		]	};
-    key <AE02> {	[	  2,	at		]	};
-    key <AE03> {	[	  3,	numbersign	]	};
-    key <AE04> {	[	  4,	dollar		]	};
-    key <AE05> {	[	  5,	percent		]	};
-    key <AE06> {	[	  6,	asciicircum	]	};
-    key <AE07> {	[	  7,	ampersand	]	};
-    key <AE08> {	[	  8,	asterisk	]	};
-    key <AE09> {	[	  9,	parenleft	]	};
-    key <AE10> {	[	  0,	parenright	]	};
-    key <AE11> {	[     minus,	underscore	]	};
-    key <AE12> {	[     equal,	plus		]	};
-
-    key <BKSL> {	[ backslash,	bar		]	};
-    key <SPCE> {	[ 	 space			]	};
+    include "pc(alpha)"
 
     // "Keypad" section
     key <KPDL> {  	[  KP_Delete,	KP_Decimal	]	};
@@ -249,7 +250,31 @@
     key <LWIN> {	[	Super_L			]	};
     key <RWIN> {	[	Super_R			]	};
     key <MENU> {	[	Menu			]	};
+};
 
-    // the extra key on most European keyboards
-    key <LSGT> { [      less,    greater,          bar,    brokenbar ]	};
+partial hidden alphanumeric_keys
+xkb_symbols "mac_keypad" {
+    key <NMLK> {	[  Num_Lock,	Pointer_EnableKeys	]	};
+    key <KPEQ> {	[  equal				]	};
+    key <KPDV> {	[  KP_Divide				]	};
+    key <KPMU> {	[  KP_Multiply				]	};
+
+    key  <KP7> {	[  KP_7,	KP_Home			]	};
+    key  <KP8> {	[  KP_8,	KP_Up			]	};
+    key  <KP9> {	[  KP_9,	KP_Prior		]	};
+    key <KPSU> {	[  KP_Subtract				]	};
+
+    key  <KP4> {	[  KP_4,	KP_Left			]	};
+    key  <KP5> {	[  KP_5,	KP_Begin		]	};
+    key  <KP6> {	[  KP_6,	KP_Right		]	};
+    key <KPAD> {	[  KP_Add				]	};
+
+    key  <KP1> {	[  KP_1,	KP_End			]	};
+    key  <KP2> {	[  KP_2,	KP_Down			]	};
+    key  <KP3> {	[  KP_3,	KP_Next			]	};
+    key <KPEN> {	[  KP_Enter				]	};
+
+    key  <KP0> {	[  KP_0,	KP_Insert		]	};
+    key <KPDL> { 	[  KP_Decimal,	KP_Delete		]	};
 };
+
Index: xkb-data/symbols/us
===================================================================
--- xkb-data.orig/symbols/us
+++ xkb-data/symbols/us
@@ -13,20 +13,6 @@
     include "pc(common)"
 
     // Alphanumeric section
-    key <TLDE> {	[     grave,	asciitilde	]	};
-    key <AE01> {	[	  1,	exclam 		]	};
-    key <AE02> {	[	  2,	at		]	};
-    key <AE03> {	[	  3,	numbersign	]	};
-    key <AE04> {	[	  4,	dollar		]	};
-    key <AE05> {	[	  5,	percent		]	};
-    key <AE06> {	[	  6,	asciicircum	]	};
-    key <AE07> {	[	  7,	ampersand	]	};
-    key <AE08> {	[	  8,	asterisk	]	};
-    key <AE09> {	[	  9,	parenleft	]	};
-    key <AE10> {	[	  0,	parenright	]	};
-    key <AE11> {	[     minus,	underscore	]	};
-    key <AE12> {	[     equal,	plus		]	};
-
     key <AD01> {	[	  q,	Q 		]	};
     key <AD02> {	[	  w,	W		]	};
     key <AD03> {	[	  e,	E		]	};
@@ -63,7 +49,6 @@
     key <AB09> {	[    period,	greater		]	};
     key <AB10> {	[     slash,	question	]	};
 
-    key <BKSL> {	[ backslash,         bar	]	};
     // End alphanumeric section
 };
 
